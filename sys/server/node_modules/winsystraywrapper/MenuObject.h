#pragma once

#pragma warning (disable: 4506) // v8 can probably be forgiven this nonsense: no definition for inline function 'v8::Persistent<T> v8::Persistent<T>::New(v8::Handle<T>)
#pragma warning (disable: 4530) // This is a node-gyp issue: C++ exception handler used, but unwind semantics are not enabled. Specify /EHsc

// A bit of MFC stuff
#define WINVER 0x0600
#include <afxdisp.h>

// A bit of JavaScript stuff
#include <node.h>
#include <v8.h>
using namespace v8;

// A bit of STL stuff
#include <vector>
#include <map>

class CMenuObject
{
public:

	CMenuObject(Local<Object> oMenu);
	virtual ~CMenuObject();

	int GetLength();
	CString GetCaption(int nItem);
	bool DoAction(int nItem);
	bool DoDefaultAction();

private:

	Local<Object> m_oMenu;

};

CString AsCString(Value* value);
