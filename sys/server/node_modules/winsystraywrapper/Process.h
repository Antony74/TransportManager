#pragma once

#pragma warning (disable: 4506) // v8 can probably be forgiven this nonsense: no definition for inline function 'v8::Persistent<T> v8::Persistent<T>::New(v8::Handle<T>)
#pragma warning (disable: 4530) // This is a node-gyp issue: C++ exception handler used, but unwind semantics are not enabled. Specify /EHsc

// A bit of MFC stuff
#define WINVER 0x0600
#include <afxdisp.h>

class CProcess
{
public:
	CProcess();
	CProcess(DWORD dwPID);
	CProcess(HANDLE hProcess);
	HANDLE GetProcessHandle() {return m_hProcess;}
	DWORD GetPID() {return m_dwPID;}
	HWND GetMainWnd() {return m_hWndMain;}
	void SetMainWnd(HWND hWnd) {m_hWndMain = hWnd;}
	CString GetExeFile() {return m_sExeFile;}

	CProcess GetParent();

private:
	HANDLE m_hProcess;
	DWORD m_dwPID;
	HWND m_hWndMain;
	CString m_sExeFile;
};

//DWORD GetParentProcessId();

